<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Access | AURA DIGITAL STORE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        body { font-family: 'Inter', sans-serif; background: #050b14; color: white; }
        .input-box { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); outline: none; }
        .input-box:focus { border-color: #3b82f6; box-shadow: 0 0 15px rgba(59,130,246,0.2); }
        .tab-active { color: #3b82f6; border-bottom: 2px solid #3b82f6; }
    </style>
</head>
<body class="h-screen flex items-center justify-center p-6 bg-[#050b14]">
    <div class="w-full max-w-md bg-[#0b1121] p-8 rounded-[32px] border border-slate-800 shadow-2xl">
        <div class="text-center mb-10">
            <h1 class="text-3xl font-black italic">AURA <span class="text-blue-500">DIGITAL</span></h1>
        </div>

        <div class="flex gap-6 mb-8 border-b border-slate-800">
            <button id="loginTab" onclick="switchTab('login')" class="pb-2 font-bold tab-active">Login</button>
            <button id="regTab" onclick="switchTab('reg')" class="pb-2 font-bold text-slate-500">Register</button>
        </div>

        <div id="loginSection" class="space-y-4">
            <input type="email" id="lEmail" placeholder="Email" class="input-box w-full p-4 rounded-2xl font-bold">
            <input type="password" id="lPass" placeholder="Password" class="input-box w-full p-4 rounded-2xl font-bold">
            <button onclick="handleLogin()" class="w-full bg-blue-600 py-4 rounded-2xl font-black uppercase tracking-widest mt-4">Login</button>
        </div>

        <div id="regSection" class="hidden space-y-4">
            <input type="text" id="rName" placeholder="Full Name" class="input-box w-full p-4 rounded-2xl font-bold">
            <input type="email" id="rEmail" placeholder="Email" class="input-box w-full p-4 rounded-2xl font-bold">
            <input type="password" id="rPass" placeholder="Password" class="input-box w-full p-4 rounded-2xl font-bold">
            <div class="grid grid-cols-2 gap-2">
                <select id="rCountry" class="input-box p-4 rounded-2xl font-bold text-slate-400"><option value="BD">BD</option><option value="IN">IN</option></select>
                <input type="text" id="rRef" placeholder="Ref Code" class="input-box p-4 rounded-2xl font-bold">
            </div>
            <button onclick="handleRegister()" class="w-full bg-slate-100 text-black py-4 rounded-2xl font-black uppercase tracking-widest mt-4">Create Account</button>
        </div>
    </div>

    <script>
        function switchTab(t) {
            document.getElementById('loginSection').classList.toggle('hidden', t === 'reg');
            document.getElementById('regSection').classList.toggle('hidden', t === 'login');
            document.getElementById('loginTab').className = t === 'login' ? 'pb-2 font-bold tab-active' : 'pb-2 font-bold text-slate-500';
            document.getElementById('regTab').className = t === 'reg' ? 'pb-2 font-bold tab-active' : 'pb-2 font-bold text-slate-500';
        }

        async function handleLogin() {
            const email = document.getElementById('lEmail').value;
            const password = document.getElementById('lPass').value;
            const res = await fetch('/api/login', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({email, password}) });
            const data = await res.json();
            if(data.success) { localStorage.setItem('user', JSON.stringify(data.user)); location.href = '/'; }
            else Swal.fire('Error', 'Login failed', 'error');
        }

        async function handleRegister() {
            const name = document.getElementById('rName').value;
            const email = document.getElementById('rEmail').value;
            const password = document.getElementById('rPass').value;
            const country = document.getElementById('rCountry').value;
            const refCode = document.getElementById('rRef').value;
            const res = await fetch('/api/register', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({name, email, password, country, refCode}) });
            const data = await res.json();
            if(data.success) { Swal.fire('Success', 'Account Created! Please Login.', 'success'); switchTab('login'); }
            else Swal.fire('Error', data.error || 'Failed', 'error');
        }
    </script>
</body>
</html>
